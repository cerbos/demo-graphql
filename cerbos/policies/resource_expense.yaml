---
apiVersion: cerbos.dev/v1
resourcePolicy:
  version: "default"
  importDerivedRoles:
    - common_roles
  resource: "expense:object"
  rules:
    - actions: ['*']
      effect: EFFECT_ALLOW
      roles:
        - ADMIN
    - actions: ['view']
      effect: EFFECT_ALLOW
      derivedRoles:
        - OWNER
        - FINANCE
        - REGION_MANAGER
    - actions: ['view:approver']
      effect: EFFECT_ALLOW
      derivedRoles:
        - OWNER
        - FINANCE
    - actions: ['approve']
      effect: EFFECT_ALLOW
      derivedRoles:
        - FINANCE
    # - action: 'update'
    #   effect: EFFECT_ALLOW
    #   derivedRoles:
    #     - OWNER
    #     - FINANCE
    #     - REGION_MANAGER
    #   condition:
    #     match:
    #       expr:
    #         - request.resource.attr.region == request.principal.attr.region        
    # - action: 'delete'
    #   effect: EFFECT_ALLOW
    #   derivedRoles:
    #     - OWNER
    #     - FINANCE        
